var _0xods='jsjiami.cn.v7';const _0x5d1b9a=_0x55b0;(function(_0x38bdb5,_0x2cf0ae,_0x39f2e5,_0x529e81,_0x552dfb,_0x42d267,_0x6354b3){return _0x38bdb5=_0x38bdb5>>0x2,_0x42d267='hs',_0x6354b3='hs',function(_0x5b681c,_0x3c75b9,_0x4ae663,_0x3b87b7,_0x182705){const _0xeeea6f=_0x55b0;_0x3b87b7='tfi',_0x42d267=_0x3b87b7+_0x42d267,_0x182705='up',_0x6354b3+=_0x182705,_0x42d267=_0x4ae663(_0x42d267),_0x6354b3=_0x4ae663(_0x6354b3),_0x4ae663=0x0;const _0x27be5a=_0x5b681c();while(!![]&&--_0x529e81+_0x3c75b9){try{_0x3b87b7=-parseInt(_0xeeea6f(0x94,'hxo]'))/0x1+-parseInt(_0xeeea6f(0xce,'1hBn'))/0x2+-parseInt(_0xeeea6f(0xb9,'Z^h]'))/0x3+-parseInt(_0xeeea6f(0x68,'l9$r'))/0x4+-parseInt(_0xeeea6f(0x71,'Gjt1'))/0x5+-parseInt(_0xeeea6f(0x9f,'o4D@'))/0x6*(-parseInt(_0xeeea6f(0x84,'1hBn'))/0x7)+parseInt(_0xeeea6f(0x79,'Z^h]'))/0x8;}catch(_0x99615f){_0x3b87b7=_0x4ae663;}finally{_0x182705=_0x27be5a[_0x42d267]();if(_0x38bdb5<=_0x529e81)_0x4ae663?_0x552dfb?_0x3b87b7=_0x182705:_0x552dfb=_0x182705:_0x4ae663=_0x182705;else{if(_0x4ae663==_0x552dfb['replace'](/[tKufQRWUrEbdgLyoeIw=]/g,'')){if(_0x3b87b7===_0x3c75b9){_0x27be5a['un'+_0x42d267](_0x182705);break;}_0x27be5a[_0x6354b3](_0x182705);}}}}}(_0x39f2e5,_0x2cf0ae,function(_0x41eaf8,_0x37be75,_0x5829d8,_0x3eae9a,_0x5be204,_0x2006bd,_0x232f90){return _0x37be75='\x73\x70\x6c\x69\x74',_0x41eaf8=arguments[0x0],_0x41eaf8=_0x41eaf8[_0x37be75](''),_0x5829d8=`\x72\x65\x76\x65\x72\x73\x65`,_0x41eaf8=_0x41eaf8[_0x5829d8]('\x76'),_0x3eae9a=`\x6a\x6f\x69\x6e`,(0x180115,_0x41eaf8[_0x3eae9a](''));});}(0x308,0xc91d8,_0x38be,0xc4),_0x38be)&&(_0xods=0x4e08);function _0x55b0(_0x4f57f8,_0x29fd4d){const _0xa2135c=_0x38be();return _0x55b0=function(_0x40fde6,_0x41cb41){_0x40fde6=_0x40fde6-0x67;let _0x38be01=_0xa2135c[_0x40fde6];if(_0x55b0['kibDAx']===undefined){var _0x55b054=function(_0x354bca){const _0x1cd025='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x34b2a7='',_0x16ab96='',_0x42698c=_0x34b2a7+_0x55b054;for(let _0x195c32=0x0,_0x627d69,_0x3a78dd,_0x185ade=0x0;_0x3a78dd=_0x354bca['charAt'](_0x185ade++);~_0x3a78dd&&(_0x627d69=_0x195c32%0x4?_0x627d69*0x40+_0x3a78dd:_0x3a78dd,_0x195c32++%0x4)?_0x34b2a7+=_0x42698c['charCodeAt'](_0x185ade+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x627d69>>(-0x2*_0x195c32&0x6)):_0x195c32:0x0){_0x3a78dd=_0x1cd025['indexOf'](_0x3a78dd);}for(let _0x4d2907=0x0,_0x5ae64b=_0x34b2a7['length'];_0x4d2907<_0x5ae64b;_0x4d2907++){_0x16ab96+='%'+('00'+_0x34b2a7['charCodeAt'](_0x4d2907)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x16ab96);};const _0x5db715=function(_0x597ba6,_0x51fe26){let _0x1a8890=[],_0x60e8cb=0x0,_0x1f8dde,_0x3e311e='';_0x597ba6=_0x55b054(_0x597ba6);let _0x42c0cc;for(_0x42c0cc=0x0;_0x42c0cc<0x100;_0x42c0cc++){_0x1a8890[_0x42c0cc]=_0x42c0cc;}for(_0x42c0cc=0x0;_0x42c0cc<0x100;_0x42c0cc++){_0x60e8cb=(_0x60e8cb+_0x1a8890[_0x42c0cc]+_0x51fe26['charCodeAt'](_0x42c0cc%_0x51fe26['length']))%0x100,_0x1f8dde=_0x1a8890[_0x42c0cc],_0x1a8890[_0x42c0cc]=_0x1a8890[_0x60e8cb],_0x1a8890[_0x60e8cb]=_0x1f8dde;}_0x42c0cc=0x0,_0x60e8cb=0x0;for(let _0x935c2=0x0;_0x935c2<_0x597ba6['length'];_0x935c2++){_0x42c0cc=(_0x42c0cc+0x1)%0x100,_0x60e8cb=(_0x60e8cb+_0x1a8890[_0x42c0cc])%0x100,_0x1f8dde=_0x1a8890[_0x42c0cc],_0x1a8890[_0x42c0cc]=_0x1a8890[_0x60e8cb],_0x1a8890[_0x60e8cb]=_0x1f8dde,_0x3e311e+=String['fromCharCode'](_0x597ba6['charCodeAt'](_0x935c2)^_0x1a8890[(_0x1a8890[_0x42c0cc]+_0x1a8890[_0x60e8cb])%0x100]);}return _0x3e311e;};_0x55b0['vyhPDO']=_0x5db715,_0x4f57f8=arguments,_0x55b0['kibDAx']=!![];}const _0x47fad0=_0xa2135c[0x0],_0xef4c8c=_0x40fde6+_0x47fad0,_0x56a4ca=_0x4f57f8[_0xef4c8c];if(!_0x56a4ca){if(_0x55b0['RxEcFp']===undefined){const _0x532c6f=function(_0x507843){this['yuEOuk']=_0x507843,this['CinuII']=[0x1,0x0,0x0],this['HDMGEz']=function(){return'newState';},this['jaJLGc']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['nnUaeP']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x532c6f['prototype']['QIlbOI']=function(){const _0x416817=new RegExp(this['jaJLGc']+this['nnUaeP']),_0x310538=_0x416817['test'](this['HDMGEz']['toString']())?--this['CinuII'][0x1]:--this['CinuII'][0x0];return this['cllnfA'](_0x310538);},_0x532c6f['prototype']['cllnfA']=function(_0x303a0e){if(!Boolean(~_0x303a0e))return _0x303a0e;return this['wwHFBN'](this['yuEOuk']);},_0x532c6f['prototype']['wwHFBN']=function(_0x3fd98b){for(let _0x1f2043=0x0,_0xe16b89=this['CinuII']['length'];_0x1f2043<_0xe16b89;_0x1f2043++){this['CinuII']['push'](Math['round'](Math['random']())),_0xe16b89=this['CinuII']['length'];}return _0x3fd98b(this['CinuII'][0x0]);},new _0x532c6f(_0x55b0)['QIlbOI'](),_0x55b0['RxEcFp']=!![];}_0x38be01=_0x55b0['vyhPDO'](_0x38be01,_0x41cb41),_0x4f57f8[_0xef4c8c]=_0x38be01;}else _0x38be01=_0x56a4ca;return _0x38be01;},_0x55b0(_0x4f57f8,_0x29fd4d);}const _0x5722b5=(function(){const _0x4b443b=_0x55b0,_0x28b869={'twWOk':_0x4b443b(0x7c,'c)y@'),'LgVqp':function(_0x5de723,_0x118bfa){return _0x5de723!==_0x118bfa;},'KEKMz':_0x4b443b(0x9b,'LUMU'),'MkDNr':_0x4b443b(0xa8,'NZZN'),'CYGQk':_0x4b443b(0xa0,'hxo]'),'qAozV':_0x4b443b(0x98,'g&Hi'),'buBWv':_0x4b443b(0xa7,'bhCJ'),'Blodh':_0x4b443b(0x93,'g&Hi'),'UOieC':_0x4b443b(0xa3,'DdOR'),'eGMDd':_0x4b443b(0x76,'rmio'),'xbYxi':function(_0x2d6129,_0x2c370f){return _0x2d6129+_0x2c370f;},'bevbQ':_0x4b443b(0x8b,'xCMc'),'PjORz':function(_0xbd2eb,_0x14207f){return _0xbd2eb(_0x14207f);},'ANauC':_0x4b443b(0x8c,'DdOR'),'KftUE':_0x4b443b(0xb4,'^BL]'),'aPZTb':_0x4b443b(0xd0,'q2yu'),'RHkVW':_0x4b443b(0x70,'1hBn'),'btblv':function(_0x1e99ea,_0x3685ea){return _0x1e99ea!==_0x3685ea;},'urjbK':_0x4b443b(0x8f,'rlYk')};let _0x459d00=!![];return function(_0x370723,_0x5685db){const _0x44c3e4=_0x4b443b,_0x1a6cfc={'IdHbX':function(_0x17e20d,_0x4fd0d7){const _0xba4806=_0x55b0;return _0x28b869[_0xba4806(0x88,'7JP)')](_0x17e20d,_0x4fd0d7);},'cANUE':_0x28b869[_0x44c3e4(0xa6,'xkYc')]};if(_0x28b869[_0x44c3e4(0xbd,'mqXg')](_0x28b869[_0x44c3e4(0x7d,'^VGR')],_0x28b869[_0x44c3e4(0x83,'DdOR')]))try{const _0xa3f784=_0x1737e3[_0x44c3e4(0xc6,'rlYk')](_0x28b869[_0x44c3e4(0x69,'xkYc')]);if(!_0xa3f784||_0x28b869[_0x44c3e4(0xb1,'l9$r')](_0xa3f784,_0x571aad)){_0x279375[_0x44c3e4(0xb2,'WuSu')](_0x52591a,_0x28b869[_0x44c3e4(0x91,'b[oe')]);const _0x49870d=_0x28b869[_0x44c3e4(0x75,'S6)c')];_0x36a476[_0x44c3e4(0x90,'b[oe')](_0x28b869[_0x44c3e4(0xba,'@XUo')],_0x28b869[_0x44c3e4(0xb7,'q2yu')],_0x28b869[_0x44c3e4(0x9a,'ovBT')],{'open-url':_0x5b5cdf,'media-url':_0x49870d});const _0x5ff960=_0x28b869[_0x44c3e4(0x80,'hxo]')];_0x1c4eba[_0x44c3e4(0xb0,'Z^h]')](_0x28b869[_0x44c3e4(0x8d,'ciY&')],_0x28b869[_0x44c3e4(0xbe,'^VGR')],_0x28b869[_0x44c3e4(0xc7,'^K&C')],{'open-url':_0x5ff960,'media-url':_0x49870d});const _0x23e148=_0x28b869[_0x44c3e4(0x7e,'DdOR')](_0x28b869[_0x44c3e4(0x8e,'xkYc')],_0x28b869[_0x44c3e4(0xc9,'LUMU')](_0x4456d4,_0x2b8472));_0x5f081f[_0x44c3e4(0xbb,'1hBn')](_0x28b869[_0x44c3e4(0xc1,'^K&C')],_0x28b869[_0x44c3e4(0x9e,'NZZN')],_0x28b869[_0x44c3e4(0xcc,'rlYk')],{'open-url':_0x23e148,'media-url':_0x49870d});}}catch(_0x1b4edf){_0x429d70[_0x44c3e4(0x7a,'WC&y')](_0x28b869[_0x44c3e4(0x89,'a$I&')],_0x1b4edf);}else{const _0x1a9e80=_0x459d00?function(){const _0x3665d5=_0x44c3e4;if(_0x5685db){if(_0x1a6cfc[_0x3665d5(0xa4,'o%Te')](_0x1a6cfc[_0x3665d5(0x82,'KMqB')],_0x1a6cfc[_0x3665d5(0xc5,'1hBn')])){const _0x46ce44=_0x519790[_0x3665d5(0x78,'bhCJ')](_0x38fd8e,arguments);return _0x53251c=null,_0x46ce44;}else{const _0x3b5029=_0x5685db[_0x3665d5(0x87,'bdyI')](_0x370723,arguments);return _0x5685db=null,_0x3b5029;}}}:function(){};return _0x459d00=![],_0x1a9e80;}};}()),_0x43492b=_0x5722b5(this,function(){const _0x1a9e74=_0x55b0,_0x252e19={'GMUkk':_0x1a9e74(0x6d,'1hBn')};return _0x43492b[_0x1a9e74(0xa9,'UEhZ')]()[_0x1a9e74(0xbf,'a$I&')](_0x252e19[_0x1a9e74(0xca,'SO]j')])[_0x1a9e74(0x74,'rlYk')]()[_0x1a9e74(0x6a,'^K&C')](_0x43492b)[_0x1a9e74(0x6c,'B8Js')](_0x252e19[_0x1a9e74(0x77,'@XUo')]);});_0x43492b();const _0x4e4124=new Env(_0x5d1b9a(0x6e,'z2(1'));let _0x52307a=$request[_0x5d1b9a(0x81,'xkYc')],_0x5a89e0=$request[_0x5d1b9a(0x7f,'xi3]')];_0x52307a=_0x52307a[_0x5d1b9a(0xae,'v^P#')](/\/\/120play\//g,_0x5d1b9a(0x86,'ovBT')),_0x52307a=_0x52307a[_0x5d1b9a(0xac,'^BL]')](/\/\/h5play\//g,_0x5d1b9a(0xc3,'I7yY')),_0x52307a=_0x52307a[_0x5d1b9a(0xb6,'c71n')](/\.m3u8/,_0x5d1b9a(0xb3,'^BL]'));if(_0x5a89e0[_0x5d1b9a(0xa1,'xCMc')](_0x5d1b9a(0x99,'rmio'))||_0x5a89e0[_0x5d1b9a(0xcb,'bhCJ')](_0x5d1b9a(0x67,'@XUo')))try{const _0x2152f1=_0x4e4124[_0x5d1b9a(0xab,'c)y@')](_0x5d1b9a(0xcf,'l9$r'));if(!_0x2152f1||_0x2152f1!==_0x52307a){_0x4e4124[_0x5d1b9a(0x6b,'2Unr')](_0x52307a,_0x5d1b9a(0xaf,'g&Hi'));const _0x232fce=_0x5d1b9a(0xaa,'S6)c');_0x4e4124[_0x5d1b9a(0x6f,'v^P#')](_0x5d1b9a(0xc8,'Z^h]'),_0x5d1b9a(0xb8,'Vo]a'),_0x5d1b9a(0x7b,'^VGR'),{'open-url':_0x52307a,'media-url':_0x232fce});const _0x4506bf=_0x5d1b9a(0xc0,'oBXl');_0x4e4124[_0x5d1b9a(0xb0,'Z^h]')](_0x5d1b9a(0xa2,'I7yY'),_0x5d1b9a(0x92,'bdyI'),_0x5d1b9a(0x9c,'Z^h]'),{'open-url':_0x4506bf,'media-url':_0x232fce});const _0xc42e75=_0x5d1b9a(0xa5,'WuSu')+encodeURIComponent(_0x52307a);_0x4e4124[_0x5d1b9a(0xcd,'SO]j')](_0x5d1b9a(0x9d,'0TBK'),_0x5d1b9a(0x96,'hxo]'),_0x5d1b9a(0x85,'I7yY'),{'open-url':_0xc42e75,'media-url':_0x232fce});}}catch(_0x27e765){console[_0x5d1b9a(0xc4,'o4D@')](_0x5d1b9a(0x97,'xi3]'),_0x27e765);}_0x4e4124[_0x5d1b9a(0x73,'a$I&')]({});function _0x38be(){const _0x388f87=(function(){return[...[_0xods,'KRjWusEjfIiKamtiQ.wyQcrneo.vb7dUQugQeLe==','WOxcM2O6hW','yMBdRKDokw3dLCoQWPGVxYHe','lWtdImomW7G','WQ/cPvG','WOCnWPmUWQXtDctdTmkNoCkn','W7fXW6RdQG','zSoKWPj8WQJcQCo/W55tW4FdH8kIW6VcQ8kjsgvx','vSkOimoaWRRdOGBdJSoBW6JdNhvnW7FdSw/dUeBdLGKa','WQ91WQFdOSojdYyUg8oVkCoauq','WP52gG8L','AmoOWOrdiqHVsCkJW57dHW','tsBdGmoMW5ldUXe','B8oLkmk9ESo+','WPKDWO0YWRnclwxcTmo7xCoG','lMBdOCkM5lUN5l+P5OYo5l626kAa6zER5P+R5yQj','jCoXaG','W5rBW6nEW4i','FmoyB8oWW5TTASkRkCoAuIq','hKlcJCkeW4bPmsxcMsDpWQVdMq','yuddOmk+','ea3dR8oTW498W6ldOq','WOOQW47dImoQ','54kP5ywf5lQr6l2zW6OGW5xcJJNLUihNLBS','sCoijCohWRa','A3FdRwra','WQ3dH8kJW6ddJmkhW41XFNzyWQlcRdG','W6tdNstdPSkH','54kj5yEV5l+H55wewehcOcPlWPNMT4BOP4VLMl3OPQFNNRO','lZ1zW4y','rwBdTa5a','brxdUuBcQW','EsddJqzaW7RcUW','v8oxW7xcGKO','WP9Ziq','WQ1+s3pdMa','caxdILZcIq','WOmmWP0UWQ8yBYpdTmkOhW','54oo5ysz5l6O55ASW4ZcJCo8W5as5RwM6kAX5zQz6kET556L5yYd5lIM6l+F','W51tkmo7uSkw','taxdHCoyWOW','WR9Eu3mD','zh/dLmkpvW','WQFcJhuvc8ofe1VdIgJcOSkgj8oP','WOJcIvxcSLTjhd1XW5VcQCoiW5BdPuJcISoAW4/cSeddIr43WRXV','5P2r6ygT552f5l2b55EQlmooW6qXuUA2MoINPowyGW','W6rJWO/dLN8','WOHKoYiF','eXRdSSo9W64','WQhcLhy','WRJcKeBcUvy','54ku5yAo5lMq5lQ/6zcl5O+45lIc6lYX5BMD55wB56IP5BMd','5lUa6l6MW6jrW7NcO2JLU7tNLjFNQjlLUlO','dmkwWOFdPqJcPmozpSogW6ncEa'],...(function(){return['WPyIwCoaEJDssmoxsXP2','5PYz6yk4552s5l6Q55suW5pdMGFdTmoL5Rwb6kEc5zQ9','ucVcJaDxW7RcPZmcWPxdJLiNW5XBcaLb','54gY5ysG5l+C55svW4xcQM8btxdMT7ROPl3LMzJOPzNNNB0','AmktW6PiW4O1W5JcHZVdVN5tW7xdHmopW4DeoMZcGmkb','WOm9k8oUAG','qtxdGYhcHSk/W4NdPh04DunypmotW64hW4O6DCkptSktimoDtwK6nGZcPmo4W59xBSocpINcUmoQF0LbW63dRG3dMCkmsJLgW61GWPxcSSktCLVdPCktC2RdTW','54cM5ysp5lQE6l6RWRVdMCkrk1dLUPVNLki','W5BdIUIKTUMGJUIpOowoIEAiK+wkKa','yCkHEatcJa','rMFcSY/cPMNdRmkGxc4','5PYz6yk4552s5l6Q55suW4hdLW7dVCo2z+A1HEIKNEwBRW','WOhcHeNcLu1fpIbPW5JcQCoiWPJcSW','5lM86l6FWPBdQmoIWONdSUw4RoEvM+EOOUw7TG','54oe5yAm5lMf5lI16zc85O+i5lQP6l+25BUn55sB56UC5BQJ','WRKiDstdHW','W5n5b30DASkyyYpdPCoeW7hcPGNdNr3dTSkGW6vvySknmhpdGa','WRHjjHyz','yNpdQxHkFrlcImoKWPG6xNjCEWj9WR5lW4rmF8kmg8kGWOHdoL7dS1tdK8oqxCoLCSk3jmkqEr3cU0umWRpcOg7dHJ41WQNcRJBdHCoXWRvJt8ohxmoCW5FcQeBdNwJcP2TJWR7cRtZdOmoED8k5WOz+WPxcHmk3tmohmSoBAxGnWQJdR8kZf14QsrP/d8o/bCo0d0SaW4G4WRPNsaSbWR/cPCo/pcHGkSkdWR8Np8kRWP4jumo8W4DZqwBcPGBcQ2hcR8oUBW','yCk56kEF6AoG6i245y2k5OIv5yQp','W6OoW5RcOSkVWQLkhq','WQKBW7hdTCoJchtcVmoKmapcJaXufGaQzCkRxa0jWOBdLCkJW5BcG8oswhpdOhDMW7BcGmk+xc0RW6KRnt5xWP/cOmk7dYC6WQVdKHRcKtySWO3cKCk/W4hcVSoEcq','jwTyWPPcWOddTq','W74Rnmkfnwj/','W4qpnZTEn8o0DSk+W5/cTmor','oSoNfCklaGxdSG','WQBdQmowbq','W7lcH8oY','W5aLW4NcO8km','W4fWhheDFmkl','WQiJD8kCBa','54c15yA15lY755Ebfw11WPr65RsN6kEP5zUU6kwW552/5yYG5lMC6l23','W5W5E3j6cCk9WQbFWRaKW6K','cmouosmbW7pcJq','zmotW7viWRe','5P+F6ygA55Yt5l6z55AIwSo4DftcJJpMTlFOPyVLMk4','WQVdHCkMW6FdI8kcW4Oly01SWQFcKG','q8oUnmoIWQK','W5XgW4i','iSkhWQiwWPW/W5pcItpdRZO','s8o4WQ1dWPy','zvVdTWLi','DKRdR8kPvSod','W4SLBt3cN1L+oxFcJtldKmkzx8kvrsJcJf/dSSkRW4Kvy0JdSXJcSK11uuznW67cOmoVt8kVAGeefCoHWOVdImoobmk/yhfMzSodxSoxkCkKWQFdThv7WPvbWRFcOW1zWQmSW7RdNxFdTSkaW4GfW5anWQ8iW5PXWPFcS17cPvreWPtcP3pcP0WPvgyaWOtdKLBcMN9WjtpcJCkqW6tcSftdLSotW5NdGCkNi8oOW7VcJCkNnqBcPmoGumkpdHFcMCkdW6NcJmkeW7dcH3tdKSo/','rSoSWQ5+jW','jmkpWQKvWPP7WO7cRGRdLZvpW5W','wmonWRVdQ8oJWOy','esFdUxBcSq','W5j0W6TjW50','aWFdImo9W5XHW60','BSoaWQD0mq','W57cOUILK+MHH+InJEwnO+AlRUwlNa','EsVdUapcJW'];}())];}());_0x38be=function(){return _0x388f87;};return _0x38be();};
function Env(t,e){class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,a)=>{s.call(this,t,(t,s,r)=>{t?a(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.encoding="utf-8",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}getEnv(){return"undefined"!=typeof $environment&&$environment["surge-version"]?"Surge":"undefined"!=typeof $environment&&$environment["stash-version"]?"Stash":"undefined"!=typeof module&&module.exports?"Node.js":"undefined"!=typeof $task?"Quantumult X":"undefined"!=typeof $loon?"Loon":"undefined"!=typeof $rocket?"Shadowrocket":void 0}isNode(){return"Node.js"===this.getEnv()}isQuanX(){return"Quantumult X"===this.getEnv()}isSurge(){return"Surge"===this.getEnv()}isLoon(){return"Loon"===this.getEnv()}isShadowrocket(){return"Shadowrocket"===this.getEnv()}isStash(){return"Stash"===this.getEnv()}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const a=this.getdata(t);if(a)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,a)=>e(a))})}runScript(t,e){return new Promise(s=>{let a=this.getdata("@chavy_boxjs_userCfgs.httpapi");a=a?a.replace(/\n/g,"").trim():a;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[i,o]=a.split("@"),n={url:`http://${o}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":i,Accept:"*/*"},timeout:r};this.post(n,(t,e,a)=>s(a))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),a=!s&&this.fs.existsSync(e);if(!s&&!a)return{};{const a=s?t:e;try{return JSON.parse(this.fs.readFileSync(a))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),a=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):a?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const a=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of a)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,a)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[a+1])>>0==+e[a+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,a]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,a,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,a,r]=/^@(.*?)\.(.*?)$/.exec(e),i=this.getval(a),o=a?"null"===i?null:i||"{}":"{}";try{const e=JSON.parse(o);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),a)}catch(e){const i={};this.lodash_set(i,r,t),s=this.setval(JSON.stringify(i),a)}}else s=this.setval(t,e);return s}getval(t){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":return $persistentStore.read(t);case"Quantumult X":return $prefs.valueForKey(t);case"Node.js":return this.data=this.loaddata(),this.data[t];default:return this.data&&this.data[t]||null}}setval(t,e){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":return $persistentStore.write(t,e);case"Quantumult X":return $prefs.setValueForKey(t,e);case"Node.js":return this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0;default:return this.data&&this.data[e]||null}}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){switch(t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"],delete t.headers["content-type"],delete t.headers["content-length"]),t.params&&(t.url+="?"+this.queryStr(t.params)),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,a)=>{!t&&s&&(s.body=a,s.statusCode=s.status?s.status:s.statusCode,s.status=s.statusCode),e(t,s,a)});break;case"Quantumult X":this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:a,headers:r,body:i,bodyBytes:o}=t;e(null,{status:s,statusCode:a,headers:r,body:i,bodyBytes:o},i,o)},t=>e(t&&t.error||"UndefinedError"));break;case"Node.js":let s=require("iconv-lite");this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:a,statusCode:r,headers:i,rawBody:o}=t,n=s.decode(o,this.encoding);e(null,{status:a,statusCode:r,headers:i,rawBody:o,body:n},n)},t=>{const{message:a,response:r}=t;e(a,r,r&&s.decode(r.rawBody,this.encoding))})}}post(t,e=(()=>{})){const s=t.method?t.method.toLocaleLowerCase():"post";switch(t.body&&t.headers&&!t.headers["Content-Type"]&&!t.headers["content-type"]&&(t.headers["content-type"]="application/x-www-form-urlencoded"),t.headers&&(delete t.headers["Content-Length"],delete t.headers["content-length"]),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient[s](t,(t,s,a)=>{!t&&s&&(s.body=a,s.statusCode=s.status?s.status:s.statusCode,s.status=s.statusCode),e(t,s,a)});break;case"Quantumult X":t.method=s,this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:a,headers:r,body:i,bodyBytes:o}=t;e(null,{status:s,statusCode:a,headers:r,body:i,bodyBytes:o},i,o)},t=>e(t&&t.error||"UndefinedError"));break;case"Node.js":let a=require("iconv-lite");this.initGotEnv(t);const{url:r,...i}=t;this.got[s](r,i).then(t=>{const{statusCode:s,statusCode:r,headers:i,rawBody:o}=t,n=a.decode(o,this.encoding);e(null,{status:s,statusCode:r,headers:i,rawBody:o,body:n},n)},t=>{const{message:s,response:r}=t;e(s,r,r&&a.decode(r.rawBody,this.encoding))})}}time(t,e=null){const s=e?new Date(e):new Date;let a={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in a)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?a[e]:("00"+a[e]).substr((""+a[e]).length)));return t}queryStr(t){let e="";for(const s in t){let a=t[s];null!=a&&""!==a&&("object"==typeof a&&(a=JSON.stringify(a)),e+=`${s}=${a}&`)}return e=e.substring(0,e.length-1),e}msg(e=t,s="",a="",r){const i=t=>{switch(typeof t){case void 0:return t;case"string":switch(this.getEnv()){case"Surge":case"Stash":default:return{url:t};case"Loon":case"Shadowrocket":return t;case"Quantumult X":return{"open-url":t};case"Node.js":return}case"object":switch(this.getEnv()){case"Surge":case"Stash":case"Shadowrocket":default:{let e=t.url||t.openUrl||t["open-url"];return{url:e}}case"Loon":{let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}case"Quantumult X":{let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl,a=t["update-pasteboard"]||t.updatePasteboard;return{"open-url":e,"media-url":s,"update-pasteboard":a}}case"Node.js":return}default:return}};if(!this.isMute)switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:$notification.post(e,s,a,i(r));break;case"Quantumult X":$notify(e,s,a,i(r));break;case"Node.js":}if(!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),a&&t.push(a),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":case"Quantumult X":default:this.log("",`❗️${this.name}, 错误!`,t);break;case"Node.js":this.log("",`❗️${this.name}, 错误!`,t.stack)}}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;switch(this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":case"Quantumult X":default:$done(t);break;case"Node.js":process.exit(1)}}}(t,e)}