var _0xodj='jsjiami.cn.v7';const _0x65b63e=_0x13fd;(function(_0x3984d8,_0x130a9d,_0x3dda9e,_0x3814a8,_0x48780f,_0x42e083,_0x3e73e8){return _0x3984d8=_0x3984d8>>0x5,_0x42e083='hs',_0x3e73e8='hs',function(_0x4acefe,_0x1229c9,_0x246ac3,_0x35f34e,_0x1c4077){const _0x5b414e=_0x13fd;_0x35f34e='tfi',_0x42e083=_0x35f34e+_0x42e083,_0x1c4077='up',_0x3e73e8+=_0x1c4077,_0x42e083=_0x246ac3(_0x42e083),_0x3e73e8=_0x246ac3(_0x3e73e8),_0x246ac3=0x0;const _0x57e8b3=_0x4acefe();while(!![]&&--_0x3814a8+_0x1229c9){try{_0x35f34e=parseInt(_0x5b414e(0x165,'livV'))/0x1+-parseInt(_0x5b414e(0x14c,'$2#T'))/0x2+parseInt(_0x5b414e(0x15d,'livV'))/0x3+-parseInt(_0x5b414e(0x177,'e^9#'))/0x4*(-parseInt(_0x5b414e(0x184,'OuK3'))/0x5)+-parseInt(_0x5b414e(0x173,'m9ry'))/0x6+parseInt(_0x5b414e(0x175,'YtQf'))/0x7+-parseInt(_0x5b414e(0x15c,'MMoa'))/0x8*(-parseInt(_0x5b414e(0x15f,'T]od'))/0x9);}catch(_0x7cd1aa){_0x35f34e=_0x246ac3;}finally{_0x1c4077=_0x57e8b3[_0x42e083]();if(_0x3984d8<=_0x3814a8)_0x246ac3?_0x48780f?_0x35f34e=_0x1c4077:_0x48780f=_0x1c4077:_0x246ac3=_0x1c4077;else{if(_0x246ac3==_0x48780f['replace'](/[SRDNeMFbEkgdPlVJwAH=]/g,'')){if(_0x35f34e===_0x1229c9){_0x57e8b3['un'+_0x42e083](_0x1c4077);break;}_0x57e8b3[_0x3e73e8](_0x1c4077);}}}}}(_0x3dda9e,_0x130a9d,function(_0x1df1e0,_0x676ca2,_0xf07f97,_0x34c831,_0xcfaa30,_0x2320e0,_0x5e75d6){return _0x676ca2='\x73\x70\x6c\x69\x74',_0x1df1e0=arguments[0x0],_0x1df1e0=_0x1df1e0[_0x676ca2](''),_0xf07f97=`\x72\x65\x76\x65\x72\x73\x65`,_0x1df1e0=_0x1df1e0[_0xf07f97]('\x76'),_0x34c831=`\x6a\x6f\x69\x6e`,(0x1858c6,_0x1df1e0[_0x34c831](''));});}(0x1960,0x91eba,_0x4b0d,0xcd),_0x4b0d)&&(_0xodj=0xcd);const _0x4a754d=(function(){const _0x27fddf=_0x13fd,_0x227e21={'naELa':_0x27fddf(0x18b,'%^d0'),'FBWLS':function(_0x541d5e,_0x1e4dca){return _0x541d5e===_0x1e4dca;},'dFIPn':_0x27fddf(0x182,'mCrZ'),'HwMva':function(_0x345d7e,_0x3666a8){return _0x345d7e!==_0x3666a8;},'onKDV':_0x27fddf(0x188,'quSo'),'aaOkt':_0x27fddf(0x153,'9dTT')};let _0x4f92dd=!![];return function(_0x5cb36d,_0x555347){const _0x54b5ad=_0x27fddf,_0x72e367={'EIyxu':_0x227e21[_0x54b5ad(0x15e,'T]od')],'CqGzv':function(_0x5ca72b,_0xb42ced){const _0x366891=_0x54b5ad;return _0x227e21[_0x366891(0x15a,'qam#')](_0x5ca72b,_0xb42ced);},'MCjXE':_0x227e21[_0x54b5ad(0x152,'mCrZ')],'bFIlB':function(_0x378c30,_0x382b09){const _0x225c46=_0x54b5ad;return _0x227e21[_0x225c46(0x159,'Dk6V')](_0x378c30,_0x382b09);},'ytBEe':_0x227e21[_0x54b5ad(0x17f,'!za@')],'KiSac':_0x227e21[_0x54b5ad(0x17c,'T]od')]},_0x436f73=_0x4f92dd?function(){const _0x1e1f05=_0x54b5ad;if(_0x72e367[_0x1e1f05(0x185,'%^d0')](_0x72e367[_0x1e1f05(0x16b,'HU86')],_0x72e367[_0x1e1f05(0x156,'cAjw')])){if(_0x555347){if(_0x72e367[_0x1e1f05(0x16c,'vsEh')](_0x72e367[_0x1e1f05(0x16d,'SePn')],_0x72e367[_0x1e1f05(0x183,'%^d0')])){const _0x569937=_0x555347[_0x1e1f05(0x179,'op^Y')](_0x5cb36d,arguments);return _0x555347=null,_0x569937;}else throw new _0x2a73d6(_0x72e367[_0x1e1f05(0x186,'OuK3')]);}}else{const _0x3440a0=_0x2f9fa7?function(){const _0xac7423=_0x1e1f05;if(_0x7476cb){const _0x809156=_0x3ff7d9[_0xac7423(0x178,'!X@y')](_0x2eb213,arguments);return _0x263d95=null,_0x809156;}}:function(){};return _0x1570ec=![],_0x3440a0;}}:function(){};return _0x4f92dd=![],_0x436f73;};}()),_0x106100=_0x4a754d(this,function(){const _0x4d5a0a=_0x13fd,_0x1f8f29={'HdOzp':_0x4d5a0a(0x168,'SePn')};return _0x106100[_0x4d5a0a(0x154,'8lbt')]()[_0x4d5a0a(0x172,'%^d0')](_0x1f8f29[_0x4d5a0a(0x166,'#Ey$')])[_0x4d5a0a(0x15b,'GXxf')]()[_0x4d5a0a(0x14a,'quSo')](_0x106100)[_0x4d5a0a(0x18a,'md1a')](_0x1f8f29[_0x4d5a0a(0x164,'$2#T')]);});_0x106100();function _0x4b0d(){const _0x1a42a1=(function(){return[...[_0xodj,'gPjsDVRjePRiPamElSi.wcnAwk.Hgvb7dNJFSSM==','wtyUFSksASoCWOO2WRNdObddMa','W4BdLmo+WQ8IW6tcUW','5OYK6i+Id8orWPpdO2BML4/LHQpNJ4/PLz/ORiu6','xtCNFmkweSkGWO8LWR3dVW','WPhcMSoTWQXLW5Wl','W6OxDG','WRNdVCoHpWa','smkmmchdUG','btP8W7dcS8ogkf4','wmoOW6BdHmkusmk4nIBdJgfGwa','FMqRkCoy','gSkZWRFcL8omga','WORcLby','lCk6WPdcICoW','natcOZHI','FeFcHWZdGSkTvgS','WQhdJ33dVcHFWO0npmo4WPWqW48','Cr3dSNLAWPHRW5ddJh3dISoYWPC','uMBdOCkiDq','dt/dJCkTBmoHAXy','W4ldKmo6WR82W6lcV8kIWRCBWQa','W7TTW7zofSoiwSksn3RcT8kqWRi'],...(function(){return[...['W7JcJ3ns5lQI5lY05OIG5yQg5O2C6i266kA56AoB','W6pdML9BWR/dQa','igPymSox','DXBdTxPCW6uuW5ZdH1VdQq','rSoSBqff','bx1W','yI8FAxpcH8oiW7pdI1/cJmkx','mCoVnaBKU7FKV7ZMJ43KVllMNyRLIiu','fshdV10HW4NdPej3WP4','cHpdNutcHG','DupdLenm','m3n1aJ0','WOzAlaldSwPZ','5P2f6yok55Y65l6n55Aj6iAx5AYq5lIB5RsJ6kwf5zMV','WOBcJCoVWQ92','qHTPDbORWQxdPh7cTSoOWOhcOG','imk6W61JW5yg','qmkLALddVmkVl8oAlSoZpuhdRq','qXTQDr8TWQddG3xcHSoGWPhcKa','W5ddJ8kOW7K3WOzxW4JdO0fzWP4R','gJ/dR0ZcLmoCk8obWQW','Cw7cTutcGmo3gSobWOO','W4dcVmkowM0','W6FdTWJdNM8'],...(function(){return['WOtcMSoPWQrLW4Sp','54gA5yse6iw35A2A5lMn5REW6kAM5zUx6kwB55YG','xwBdQ8kVya','W6xcJ8kCnXBcGwpcLmkh','vZ4IW68','eSkYhwRcNq','ax5J','5P6l6icX6i2j5y+G5yIKW7pcMrJcJNDRpo+9HUISUUwETmkOsmk9WQq9W4JcVos6M+I9LEIIGUMfVEE/LUocJG','WRpdLmoXbtO','gmk2W59WW5y','d2H/WR15j3/cHgGt','emkUW4TRW4m','FHG1W7bb','x2L9W5iSW7JcI1hdPvrm','WPC6WOmwxW','W6ldQbBdLW','dL3dNGBcJSom','5P256icI6iY75y+h5yQftSoiibDCWRWA77696k+h5z6iW6rmWPfkWRj6W7NKUBBOVPlOOBVPHl7NVPZJG4W','tSoSyXFdUmoAd3NcOCkkmSkpWRa','WQzAnJBdVh9Rl8ohW5HYWORdHN7cMCkwdqdcTdHPW4pdOfnipc1LaNNcPmoyWOuPWRlcNq','EgldQhxcGmo2a8os','WQW6WQ8iu8kjhCkckKlcTG','wKKIhCoOn8kYcW'];}())];}())];}());_0x4b0d=function(){return _0x1a42a1;};return _0x4b0d();};const _0x168295=new Env(_0x65b63e(0x169,'m9ry'));function _0x13fd(_0x5b83fc,_0xd7758e){const _0x3bd107=_0x4b0d();return _0x13fd=function(_0x1e1a28,_0x295cb0){_0x1e1a28=_0x1e1a28-0x149;let _0x4b0d90=_0x3bd107[_0x1e1a28];if(_0x13fd['fQSJYj']===undefined){var _0x13fd1c=function(_0x4dae19){const _0x4bd993='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1b8bd7='',_0x15298f='',_0x393792=_0x1b8bd7+_0x13fd1c;for(let _0x5eb7f0=0x0,_0xfa5b9d,_0x24cf1f,_0x2f9fa7=0x0;_0x24cf1f=_0x4dae19['charAt'](_0x2f9fa7++);~_0x24cf1f&&(_0xfa5b9d=_0x5eb7f0%0x4?_0xfa5b9d*0x40+_0x24cf1f:_0x24cf1f,_0x5eb7f0++%0x4)?_0x1b8bd7+=_0x393792['charCodeAt'](_0x2f9fa7+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0xfa5b9d>>(-0x2*_0x5eb7f0&0x6)):_0x5eb7f0:0x0){_0x24cf1f=_0x4bd993['indexOf'](_0x24cf1f);}for(let _0x17319a=0x0,_0x166fec=_0x1b8bd7['length'];_0x17319a<_0x166fec;_0x17319a++){_0x15298f+='%'+('00'+_0x1b8bd7['charCodeAt'](_0x17319a)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x15298f);};const _0x4d4257=function(_0x521130,_0x3ed0bd){let _0x1570ec=[],_0x7476cb=0x0,_0x5d9ea5,_0x3c5b2e='';_0x521130=_0x13fd1c(_0x521130);let _0x2b6909;for(_0x2b6909=0x0;_0x2b6909<0x100;_0x2b6909++){_0x1570ec[_0x2b6909]=_0x2b6909;}for(_0x2b6909=0x0;_0x2b6909<0x100;_0x2b6909++){_0x7476cb=(_0x7476cb+_0x1570ec[_0x2b6909]+_0x3ed0bd['charCodeAt'](_0x2b6909%_0x3ed0bd['length']))%0x100,_0x5d9ea5=_0x1570ec[_0x2b6909],_0x1570ec[_0x2b6909]=_0x1570ec[_0x7476cb],_0x1570ec[_0x7476cb]=_0x5d9ea5;}_0x2b6909=0x0,_0x7476cb=0x0;for(let _0x3ff7d9=0x0;_0x3ff7d9<_0x521130['length'];_0x3ff7d9++){_0x2b6909=(_0x2b6909+0x1)%0x100,_0x7476cb=(_0x7476cb+_0x1570ec[_0x2b6909])%0x100,_0x5d9ea5=_0x1570ec[_0x2b6909],_0x1570ec[_0x2b6909]=_0x1570ec[_0x7476cb],_0x1570ec[_0x7476cb]=_0x5d9ea5,_0x3c5b2e+=String['fromCharCode'](_0x521130['charCodeAt'](_0x3ff7d9)^_0x1570ec[(_0x1570ec[_0x2b6909]+_0x1570ec[_0x7476cb])%0x100]);}return _0x3c5b2e;};_0x13fd['MAxtiP']=_0x4d4257,_0x5b83fc=arguments,_0x13fd['fQSJYj']=!![];}const _0xfea57d=_0x3bd107[0x0],_0x35a87c=_0x1e1a28+_0xfea57d,_0x5ac964=_0x5b83fc[_0x35a87c];if(!_0x5ac964){if(_0x13fd['kgHxkb']===undefined){const _0x2eb213=function(_0x263d95){this['WishOt']=_0x263d95,this['JleYum']=[0x1,0x0,0x0],this['AeSjCN']=function(){return'newState';},this['PIMqAI']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['vCGMnt']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x2eb213['prototype']['MesYkU']=function(){const _0x30821a=new RegExp(this['PIMqAI']+this['vCGMnt']),_0x1508dc=_0x30821a['test'](this['AeSjCN']['toString']())?--this['JleYum'][0x1]:--this['JleYum'][0x0];return this['yWoKHU'](_0x1508dc);},_0x2eb213['prototype']['yWoKHU']=function(_0x3c23d3){if(!Boolean(~_0x3c23d3))return _0x3c23d3;return this['zcrmQA'](this['WishOt']);},_0x2eb213['prototype']['zcrmQA']=function(_0x1a79ed){for(let _0x5c6186=0x0,_0x36c8f9=this['JleYum']['length'];_0x5c6186<_0x36c8f9;_0x5c6186++){this['JleYum']['push'](Math['round'](Math['random']())),_0x36c8f9=this['JleYum']['length'];}return _0x1a79ed(this['JleYum'][0x0]);},new _0x2eb213(_0x13fd)['MesYkU'](),_0x13fd['kgHxkb']=!![];}_0x4b0d90=_0x13fd['MAxtiP'](_0x4b0d90,_0x295cb0),_0x5b83fc[_0x35a87c]=_0x4b0d90;}else _0x4b0d90=_0x5ac964;return _0x4b0d90;},_0x13fd(_0x5b83fc,_0xd7758e);}let _0xd117cc=$request[_0x65b63e(0x151,'tiA(')];_0xd117cc=_0xd117cc[_0x65b63e(0x150,'YtQf')](/\w*play/g,_0x65b63e(0x17e,'OuK3'));try{const _0x32cf43=_0x168295[_0x65b63e(0x17a,'YtQf')](_0x65b63e(0x157,'VWv2'));if(!_0x32cf43)throw new Error(_0x65b63e(0x181,'!X@y'));const _0x56ff47=_0x168295[_0x65b63e(0x14d,'DwD5')](_0x65b63e(0x187,'y3W%'));if(!_0x56ff47||_0x56ff47!==_0xd117cc){_0x168295[_0x65b63e(0x16e,'a*XY')](_0xd117cc,_0x65b63e(0x160,'DwD5'));let _0x1b1389;if(_0x32cf43===_0x65b63e(0x176,'e^9#'))_0x1b1389=_0x65b63e(0x18d,'a*XY')+encodeURIComponent(_0xd117cc);else _0x32cf43===_0x65b63e(0x163,'ms$F')?_0x1b1389=_0xd117cc:_0x1b1389=_0x32cf43[_0x65b63e(0x14b,'cAjw')](_0x65b63e(0x180,'OuK3'))?''+_0x32cf43+_0xd117cc:_0x32cf43+_0x65b63e(0x158,'ms$F')+_0xd117cc;_0x168295[_0x65b63e(0x167,'$2#T')](_0x65b63e(0x162,'5*R@'),_0x65b63e(0x16f,'VWv2'),_0x65b63e(0x17b,'YtQf'),{'open-url':_0x1b1389});}}catch(_0x17c917){console[_0x65b63e(0x170,'YtQf')](_0x65b63e(0x14e,'8lbt'),_0x17c917);}_0x168295[_0x65b63e(0x189,'op^Y')]({'url':_0xd117cc});

function Env(t,e){class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,a)=>{s.call(this,t,(t,s,r)=>{t?a(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.encoding="utf-8",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}getEnv(){return"undefined"!=typeof $environment&&$environment["surge-version"]?"Surge":"undefined"!=typeof $environment&&$environment["stash-version"]?"Stash":"undefined"!=typeof module&&module.exports?"Node.js":"undefined"!=typeof $task?"Quantumult X":"undefined"!=typeof $loon?"Loon":"undefined"!=typeof $rocket?"Shadowrocket":void 0}isNode(){return"Node.js"===this.getEnv()}isQuanX(){return"Quantumult X"===this.getEnv()}isSurge(){return"Surge"===this.getEnv()}isLoon(){return"Loon"===this.getEnv()}isShadowrocket(){return"Shadowrocket"===this.getEnv()}isStash(){return"Stash"===this.getEnv()}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const a=this.getdata(t);if(a)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,a)=>e(a))})}runScript(t,e){return new Promise(s=>{let a=this.getdata("@chavy_boxjs_userCfgs.httpapi");a=a?a.replace(/\n/g,"").trim():a;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[i,o]=a.split("@"),n={url:`http://${o}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":i,Accept:"*/*"},timeout:r};this.post(n,(t,e,a)=>s(a))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),a=!s&&this.fs.existsSync(e);if(!s&&!a)return{};{const a=s?t:e;try{return JSON.parse(this.fs.readFileSync(a))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),a=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):a?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const a=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of a)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,a)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[a+1])>>0==+e[a+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,a]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,a,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,a,r]=/^@(.*?)\.(.*?)$/.exec(e),i=this.getval(a),o=a?"null"===i?null:i||"{}":"{}";try{const e=JSON.parse(o);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),a)}catch(e){const i={};this.lodash_set(i,r,t),s=this.setval(JSON.stringify(i),a)}}else s=this.setval(t,e);return s}getval(t){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":return $persistentStore.read(t);case"Quantumult X":return $prefs.valueForKey(t);case"Node.js":return this.data=this.loaddata(),this.data[t];default:return this.data&&this.data[t]||null}}setval(t,e){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":return $persistentStore.write(t,e);case"Quantumult X":return $prefs.setValueForKey(t,e);case"Node.js":return this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0;default:return this.data&&this.data[e]||null}}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){switch(t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"],delete t.headers["content-type"],delete t.headers["content-length"]),t.params&&(t.url+="?"+this.queryStr(t.params)),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,a)=>{!t&&s&&(s.body=a,s.statusCode=s.status?s.status:s.statusCode,s.status=s.statusCode),e(t,s,a)});break;case"Quantumult X":this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:a,headers:r,body:i,bodyBytes:o}=t;e(null,{status:s,statusCode:a,headers:r,body:i,bodyBytes:o},i,o)},t=>e(t&&t.error||"UndefinedError"));break;case"Node.js":let s=require("iconv-lite");this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:a,statusCode:r,headers:i,rawBody:o}=t,n=s.decode(o,this.encoding);e(null,{status:a,statusCode:r,headers:i,rawBody:o,body:n},n)},t=>{const{message:a,response:r}=t;e(a,r,r&&s.decode(r.rawBody,this.encoding))})}}post(t,e=(()=>{})){const s=t.method?t.method.toLocaleLowerCase():"post";switch(t.body&&t.headers&&!t.headers["Content-Type"]&&!t.headers["content-type"]&&(t.headers["content-type"]="application/x-www-form-urlencoded"),t.headers&&(delete t.headers["Content-Length"],delete t.headers["content-length"]),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient[s](t,(t,s,a)=>{!t&&s&&(s.body=a,s.statusCode=s.status?s.status:s.statusCode,s.status=s.statusCode),e(t,s,a)});break;case"Quantumult X":t.method=s,this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:a,headers:r,body:i,bodyBytes:o}=t;e(null,{status:s,statusCode:a,headers:r,body:i,bodyBytes:o},i,o)},t=>e(t&&t.error||"UndefinedError"));break;case"Node.js":let a=require("iconv-lite");this.initGotEnv(t);const{url:r,...i}=t;this.got[s](r,i).then(t=>{const{statusCode:s,statusCode:r,headers:i,rawBody:o}=t,n=a.decode(o,this.encoding);e(null,{status:s,statusCode:r,headers:i,rawBody:o,body:n},n)},t=>{const{message:s,response:r}=t;e(s,r,r&&a.decode(r.rawBody,this.encoding))})}}time(t,e=null){const s=e?new Date(e):new Date;let a={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in a)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?a[e]:("00"+a[e]).substr((""+a[e]).length)));return t}queryStr(t){let e="";for(const s in t){let a=t[s];null!=a&&""!==a&&("object"==typeof a&&(a=JSON.stringify(a)),e+=`${s}=${a}&`)}return e=e.substring(0,e.length-1),e}msg(e=t,s="",a="",r){const i=t=>{switch(typeof t){case void 0:return t;case"string":switch(this.getEnv()){case"Surge":case"Stash":default:return{url:t};case"Loon":case"Shadowrocket":return t;case"Quantumult X":return{"open-url":t};case"Node.js":return}case"object":switch(this.getEnv()){case"Surge":case"Stash":case"Shadowrocket":default:{let e=t.url||t.openUrl||t["open-url"];return{url:e}}case"Loon":{let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}case"Quantumult X":{let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl,a=t["update-pasteboard"]||t.updatePasteboard;return{"open-url":e,"media-url":s,"update-pasteboard":a}}case"Node.js":return}default:return}};if(!this.isMute)switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:$notification.post(e,s,a,i(r));break;case"Quantumult X":$notify(e,s,a,i(r));break;case"Node.js":}if(!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),a&&t.push(a),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":case"Quantumult X":default:this.log("",`❗️${this.name}, 错误!`,t);break;case"Node.js":this.log("",`❗️${this.name}, 错误!`,t.stack)}}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;switch(this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":case"Quantumult X":default:$done(t);break;case"Node.js":process.exit(1)}}}(t,e)}