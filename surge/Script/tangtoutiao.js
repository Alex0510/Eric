var _0xody='jsjiami.cn.v7';const _0x25b2d8=_0x4ded;(function(_0x54ff5d,_0x13e06a,_0x57a542,_0x3e1da5,_0x199215,_0x24cc72,_0xfed2d3){return _0x54ff5d=_0x54ff5d>>0x4,_0x24cc72='hs',_0xfed2d3='hs',function(_0x19348a,_0xafd7d2,_0x3d3807,_0x56812c,_0x53aa49){const _0x115ca0=_0x4ded;_0x56812c='tfi',_0x24cc72=_0x56812c+_0x24cc72,_0x53aa49='up',_0xfed2d3+=_0x53aa49,_0x24cc72=_0x3d3807(_0x24cc72),_0xfed2d3=_0x3d3807(_0xfed2d3),_0x3d3807=0x0;const _0x3c9ce3=_0x19348a();while(!![]&&--_0x3e1da5+_0xafd7d2){try{_0x56812c=parseInt(_0x115ca0(0x1b0,'g%E#'))/0x1*(parseInt(_0x115ca0(0x19e,'MAz6'))/0x2)+parseInt(_0x115ca0(0x18c,'Zpwt'))/0x3*(-parseInt(_0x115ca0(0x1a9,'Zpwt'))/0x4)+parseInt(_0x115ca0(0x196,'Jn80'))/0x5+-parseInt(_0x115ca0(0x1be,'$9fs'))/0x6*(parseInt(_0x115ca0(0x1c4,'@sq('))/0x7)+parseInt(_0x115ca0(0x1bb,'onCJ'))/0x8*(parseInt(_0x115ca0(0x19f,'*l*C'))/0x9)+parseInt(_0x115ca0(0x1bd,'FtXd'))/0xa+-parseInt(_0x115ca0(0x1b4,'$9fs'))/0xb*(-parseInt(_0x115ca0(0x1b8,'Tgku'))/0xc);}catch(_0xa36869){_0x56812c=_0x3d3807;}finally{_0x53aa49=_0x3c9ce3[_0x24cc72]();if(_0x54ff5d<=_0x3e1da5)_0x3d3807?_0x199215?_0x56812c=_0x53aa49:_0x199215=_0x53aa49:_0x3d3807=_0x53aa49;else{if(_0x3d3807==_0x199215['replace'](/[gRfFGbEeQBtxPMChyLl=]/g,'')){if(_0x56812c===_0xafd7d2){_0x3c9ce3['un'+_0x24cc72](_0x53aa49);break;}_0x3c9ce3[_0xfed2d3](_0x53aa49);}}}}}(_0x57a542,_0x13e06a,function(_0x5c1468,_0x9c5e40,_0x555e93,_0x3bf36a,_0x376abf,_0x192870,_0x4ff235){return _0x9c5e40='\x73\x70\x6c\x69\x74',_0x5c1468=arguments[0x0],_0x5c1468=_0x5c1468[_0x9c5e40](''),_0x555e93=`\x72\x65\x76\x65\x72\x73\x65`,_0x5c1468=_0x5c1468[_0x555e93]('\x76'),_0x3bf36a=`\x6a\x6f\x69\x6e`,(0x1858da,_0x5c1468[_0x3bf36a](''));});}(0xc20,0x52bc2,_0x270f,0xc4),_0x270f)&&(_0xody=0xc99);const _0x1efd94=(function(){const _0x2e0333=_0x4ded,_0x3c4189={'cHYlI':_0x2e0333(0x1aa,'7mqS'),'Gtlmt':function(_0x38e86a,_0x3d6b09){return _0x38e86a===_0x3d6b09;},'TYaHD':_0x2e0333(0x1a2,'Imx0'),'gHANG':function(_0x3c33f7,_0x1e9128){return _0x3c33f7!==_0x1e9128;},'yXWDJ':_0x2e0333(0x19c,'TUKL')};let _0x56a14c=!![];return function(_0x331b48,_0x84172e){const _0x344f86=_0x2e0333;if(_0x3c4189[_0x344f86(0x1c0,'C)Tc')](_0x3c4189[_0x344f86(0x1a5,'$9fs')],_0x3c4189[_0x344f86(0x1a6,'Zpwt')])){if(_0x37e36d){const _0x32c53b=_0x122056[_0x344f86(0x1bf,')vYL')](_0x51b4aa,arguments);return _0x4291bd=null,_0x32c53b;}}else{const _0x322f3d=_0x56a14c?function(){const _0xfdc29a=_0x344f86,_0x5b0068={'gmRrC':_0x3c4189[_0xfdc29a(0x1ab,'VVwl')]};if(_0x84172e){if(_0x3c4189[_0xfdc29a(0x1a4,')vYL')](_0x3c4189[_0xfdc29a(0x188,'9#1b')],_0x3c4189[_0xfdc29a(0x19d,'7mqS')])){const _0xd60eb5=_0x84172e[_0xfdc29a(0x187,'*7VR')](_0x331b48,arguments);return _0x84172e=null,_0xd60eb5;}else _0x1c14c5=_0x48e9ad[_0xfdc29a(0x1c1,'00FN')](_0x5b0068[_0xfdc29a(0x1b6,'Zpwt')])?''+_0xb56b43+_0x1a416c:_0x335b27+_0xfdc29a(0x191,'Zpwt')+_0x1d2a9e;}}:function(){};return _0x56a14c=![],_0x322f3d;}};}()),_0x21c319=_0x1efd94(this,function(){const _0x5efe86=_0x4ded,_0x5361c0={'BZhDp':_0x5efe86(0x197,'onCJ')};return _0x21c319[_0x5efe86(0x19a,'hJtZ')]()[_0x5efe86(0x1ad,'sW]z')](_0x5361c0[_0x5efe86(0x1a8,'00FN')])[_0x5efe86(0x1af,'0Nat')]()[_0x5efe86(0x1cd,'pm2b')](_0x21c319)[_0x5efe86(0x1c3,'ot(P')](_0x5361c0[_0x5efe86(0x1b1,'[sS*')]);});function _0x4ded(_0x5722f9,_0x54b1c2){const _0x5d66d7=_0x270f();return _0x4ded=function(_0x516056,_0x2fe514){_0x516056=_0x516056-0x187;let _0x270f82=_0x5d66d7[_0x516056];if(_0x4ded['hAXUNH']===undefined){var _0x4ded26=function(_0x54a13e){const _0x12b7db='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x47bba2='',_0x3b1e9b='',_0x27cd1d=_0x47bba2+_0x4ded26;for(let _0x3bdf74=0x0,_0x51a3c3,_0x41ba07,_0x13b855=0x0;_0x41ba07=_0x54a13e['charAt'](_0x13b855++);~_0x41ba07&&(_0x51a3c3=_0x3bdf74%0x4?_0x51a3c3*0x40+_0x41ba07:_0x41ba07,_0x3bdf74++%0x4)?_0x47bba2+=_0x27cd1d['charCodeAt'](_0x13b855+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x51a3c3>>(-0x2*_0x3bdf74&0x6)):_0x3bdf74:0x0){_0x41ba07=_0x12b7db['indexOf'](_0x41ba07);}for(let _0x5d0be5=0x0,_0x279c1d=_0x47bba2['length'];_0x5d0be5<_0x279c1d;_0x5d0be5++){_0x3b1e9b+='%'+('00'+_0x47bba2['charCodeAt'](_0x5d0be5)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x3b1e9b);};const _0x497299=function(_0x3bd688,_0x2be1a1){let _0x2004bb=[],_0x12e4cd=0x0,_0x2a9cb8,_0xf47156='';_0x3bd688=_0x4ded26(_0x3bd688);let _0x2b1878;for(_0x2b1878=0x0;_0x2b1878<0x100;_0x2b1878++){_0x2004bb[_0x2b1878]=_0x2b1878;}for(_0x2b1878=0x0;_0x2b1878<0x100;_0x2b1878++){_0x12e4cd=(_0x12e4cd+_0x2004bb[_0x2b1878]+_0x2be1a1['charCodeAt'](_0x2b1878%_0x2be1a1['length']))%0x100,_0x2a9cb8=_0x2004bb[_0x2b1878],_0x2004bb[_0x2b1878]=_0x2004bb[_0x12e4cd],_0x2004bb[_0x12e4cd]=_0x2a9cb8;}_0x2b1878=0x0,_0x12e4cd=0x0;for(let _0x465794=0x0;_0x465794<_0x3bd688['length'];_0x465794++){_0x2b1878=(_0x2b1878+0x1)%0x100,_0x12e4cd=(_0x12e4cd+_0x2004bb[_0x2b1878])%0x100,_0x2a9cb8=_0x2004bb[_0x2b1878],_0x2004bb[_0x2b1878]=_0x2004bb[_0x12e4cd],_0x2004bb[_0x12e4cd]=_0x2a9cb8,_0xf47156+=String['fromCharCode'](_0x3bd688['charCodeAt'](_0x465794)^_0x2004bb[(_0x2004bb[_0x2b1878]+_0x2004bb[_0x12e4cd])%0x100]);}return _0xf47156;};_0x4ded['LtWXTA']=_0x497299,_0x5722f9=arguments,_0x4ded['hAXUNH']=!![];}const _0x43aeac=_0x5d66d7[0x0],_0x50edd9=_0x516056+_0x43aeac,_0x532e04=_0x5722f9[_0x50edd9];if(!_0x532e04){if(_0x4ded['ImrBTe']===undefined){const _0x3de52d=function(_0x5a88cd){this['psceBl']=_0x5a88cd,this['guXcYp']=[0x1,0x0,0x0],this['xsscPH']=function(){return'newState';},this['ilkiNu']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['gWsLuL']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x3de52d['prototype']['yVcjpm']=function(){const _0xca8cbf=new RegExp(this['ilkiNu']+this['gWsLuL']),_0x10d132=_0xca8cbf['test'](this['xsscPH']['toString']())?--this['guXcYp'][0x1]:--this['guXcYp'][0x0];return this['PKJHyw'](_0x10d132);},_0x3de52d['prototype']['PKJHyw']=function(_0x3f7305){if(!Boolean(~_0x3f7305))return _0x3f7305;return this['lzGkuX'](this['psceBl']);},_0x3de52d['prototype']['lzGkuX']=function(_0x7feb3f){for(let _0x5b5009=0x0,_0x382999=this['guXcYp']['length'];_0x5b5009<_0x382999;_0x5b5009++){this['guXcYp']['push'](Math['round'](Math['random']())),_0x382999=this['guXcYp']['length'];}return _0x7feb3f(this['guXcYp'][0x0]);},new _0x3de52d(_0x4ded)['yVcjpm'](),_0x4ded['ImrBTe']=!![];}_0x270f82=_0x4ded['LtWXTA'](_0x270f82,_0x2fe514),_0x5722f9[_0x50edd9]=_0x270f82;}else _0x270f82=_0x532e04;return _0x270f82;},_0x4ded(_0x5722f9,_0x54b1c2);}_0x21c319();const _0x271482=new Env(_0x25b2d8(0x1c9,'^R6n'));function _0x270f(){const _0x3e29de=(function(){return[...[_0xody,'fjlMsGhxjePQiameibB.cRgn.tvFg7CCgCgELey==','h3CCWQldR8k1W4xdImkL','W7qdemk0WPjOW7FdV8oJEmoP','WQK8W5eIBvr4','gConWO08WQ8','bdZdUq','WRKlWOpdRSo4','WOldNCkFwMi','W4lcMs47na','W7y1pYFdL8oOWRS','zCk7Eq3dMq','WONdSK9itc4SmmkEpX/dK8or','W7CCdW','WPRdM8kYg8oB','ExrLW5DEjx4','ySkSC8kpDHW','5O+/6i26W6ztFSkdW7tML57LHAVNJ63PL4VORlZdJG','W7LItSkYW4f5W4PX','ySoAWRq5W4jNW4lcOmkBdCkc','W4BdISk0wxW','WPrDcYy','WRSjW77cIdO','W4pcSmoWkHhcSmkSW5xcHSkFW5CKua','WO42W6CzCCofW6RcR2qvW4ZcS0S','W5ZcRcSnpq','5P6N6ioW6i6Q5yYq5yQdmmo3DCkMWRddPSon77+x6kYV5zYuW7VdUti0WRaaWP7KURBOV5JOO4JPHB3NV6dJGiy','W69jW6hcKZiuxeO','q0RdPrBcQ8odWPi','WQVdJSkc','W6P5cNWwW4/dJmk4u8k2W4O','WONdTuWfp0r2bCkF','WPnMW6vcxLbQx2JcU24','W4JcTCo4krddKCoFW5dcKmkEW4O','WP8pWP/dR8o1','WRj9W5GWBq','tSkpCIxdNh/cUSke'],...(function(){return['kmkjW6XRWP5f','WQNcHr7dPCkrBW','smojmCoQlxCUW4xcGW','54gM5yEt6iAZ5A+H5lQi5RA16kAY5zIm6kA455YV','br3cOKBdUmkhWPFcGmkHWPqKrq','dchdJZtcKmoLWRFcG8oR','WRXAf8omjmo+vNu','Dv3dUbhKU7dKV5FMJkpKVzlMN7/LIy0','W65SBCkYW4zIW4fYWPVcP8oN','t8kDW6P+W7tcM0r3W6muzs0H','kJBdJq','WReulSk4wmoNWQethSkoW7y','j8k4W7vwW64','W5ddLe0csa','W5P8W4i','WRBcP8oSx01pWRvHDG','W6ibWQTggSotn8kuW7LGWOe','WOJcHGW0kfvz','W6NdKKBcPmoesSkwaCorWOPa','W5FdSCk6Fh5p','WRNcGq/dO8khDCkyaSoOWRLi','W4n1eaJcPwLV','WOhdRLy','WRSvi8kNwCoXWRed','oIRdSdr4k8kJlaznW6S0zmkObfTSWPBdGmoGWPKAW4hcKmozy8kKgXbaFbNdO2pdU3K','WOBdRJFcVUs5GUs8JoAkO+wlOoAmVUIoHEILRoMGHa','W6fIC8kH','hCknWONdR8ooW7/cQIjQWRZdTJG','W7fJg2elWQVcJmo2fmoEWOxdOa','AmoAWRq5W4T3W4ZcSmkenCkf','WQaEmmkNtCo2WRe','WRpcJmkSWRVcRCkABSoB','5P6A6ycz55Y65l2s55wG6isz5A2b5lQ15RwS6kA35zU8','E3Tsnt8','WPLQqColW6C','WR8Fi8orpmoEEa'];}())];}());_0x270f=function(){return _0x3e29de;};return _0x270f();};let _0x473a8e=$request[_0x25b2d8(0x1cc,'KHC3')];_0x473a8e=_0x473a8e[_0x25b2d8(0x199,'pm2b')](/\w*play/g,_0x25b2d8(0x195,'0Nat'));try{const _0x578077=_0x271482[_0x25b2d8(0x1a1,'OV]z')](_0x25b2d8(0x1c2,'g%E#'));if(!_0x578077)throw new Error(_0x25b2d8(0x1b7,'0Nat'));const _0x2d1820=_0x271482[_0x25b2d8(0x1ac,'&E$a')](_0x25b2d8(0x18f,'ot(P'));if(!_0x2d1820||_0x2d1820!==_0x473a8e){_0x271482[_0x25b2d8(0x1b9,'^R6n')](_0x473a8e,_0x25b2d8(0x1ca,'0Nat'));let _0x1d74f2;if(_0x578077===_0x25b2d8(0x1c7,'KHC3'))_0x1d74f2=_0x25b2d8(0x193,'DoN4')+encodeURIComponent(_0x473a8e);else _0x578077===_0x25b2d8(0x18e,'[sS*')?_0x1d74f2=_0x473a8e:_0x1d74f2=_0x578077[_0x25b2d8(0x192,'pm2b')](_0x25b2d8(0x189,'7ws['))?''+_0x578077+_0x473a8e:_0x578077+_0x25b2d8(0x1ba,'$vXW')+_0x473a8e;_0x271482[_0x25b2d8(0x1a3,'DoN4')](_0x25b2d8(0x194,'7o06'),_0x25b2d8(0x19b,'UkNr'),_0x25b2d8(0x1c5,'EmLn'),{'open-url':_0x1d74f2});}}catch(_0x34e9c8){console[_0x25b2d8(0x1b3,'Tgku')](_0x25b2d8(0x1ae,'$Q)f'),_0x34e9c8);}_0x271482[_0x25b2d8(0x1b2,'MGT2')]({'url':_0x473a8e});

function Env(t,e){class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,a)=>{s.call(this,t,(t,s,r)=>{t?a(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.encoding="utf-8",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}getEnv(){return"undefined"!=typeof $environment&&$environment["surge-version"]?"Surge":"undefined"!=typeof $environment&&$environment["stash-version"]?"Stash":"undefined"!=typeof module&&module.exports?"Node.js":"undefined"!=typeof $task?"Quantumult X":"undefined"!=typeof $loon?"Loon":"undefined"!=typeof $rocket?"Shadowrocket":void 0}isNode(){return"Node.js"===this.getEnv()}isQuanX(){return"Quantumult X"===this.getEnv()}isSurge(){return"Surge"===this.getEnv()}isLoon(){return"Loon"===this.getEnv()}isShadowrocket(){return"Shadowrocket"===this.getEnv()}isStash(){return"Stash"===this.getEnv()}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const a=this.getdata(t);if(a)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,a)=>e(a))})}runScript(t,e){return new Promise(s=>{let a=this.getdata("@chavy_boxjs_userCfgs.httpapi");a=a?a.replace(/\n/g,"").trim():a;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[i,o]=a.split("@"),n={url:`http://${o}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":i,Accept:"*/*"},timeout:r};this.post(n,(t,e,a)=>s(a))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),a=!s&&this.fs.existsSync(e);if(!s&&!a)return{};{const a=s?t:e;try{return JSON.parse(this.fs.readFileSync(a))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),a=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):a?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const a=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of a)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,a)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[a+1])>>0==+e[a+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,a]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,a,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,a,r]=/^@(.*?)\.(.*?)$/.exec(e),i=this.getval(a),o=a?"null"===i?null:i||"{}":"{}";try{const e=JSON.parse(o);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),a)}catch(e){const i={};this.lodash_set(i,r,t),s=this.setval(JSON.stringify(i),a)}}else s=this.setval(t,e);return s}getval(t){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":return $persistentStore.read(t);case"Quantumult X":return $prefs.valueForKey(t);case"Node.js":return this.data=this.loaddata(),this.data[t];default:return this.data&&this.data[t]||null}}setval(t,e){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":return $persistentStore.write(t,e);case"Quantumult X":return $prefs.setValueForKey(t,e);case"Node.js":return this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0;default:return this.data&&this.data[e]||null}}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){switch(t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"],delete t.headers["content-type"],delete t.headers["content-length"]),t.params&&(t.url+="?"+this.queryStr(t.params)),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,a)=>{!t&&s&&(s.body=a,s.statusCode=s.status?s.status:s.statusCode,s.status=s.statusCode),e(t,s,a)});break;case"Quantumult X":this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:a,headers:r,body:i,bodyBytes:o}=t;e(null,{status:s,statusCode:a,headers:r,body:i,bodyBytes:o},i,o)},t=>e(t&&t.error||"UndefinedError"));break;case"Node.js":let s=require("iconv-lite");this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:a,statusCode:r,headers:i,rawBody:o}=t,n=s.decode(o,this.encoding);e(null,{status:a,statusCode:r,headers:i,rawBody:o,body:n},n)},t=>{const{message:a,response:r}=t;e(a,r,r&&s.decode(r.rawBody,this.encoding))})}}post(t,e=(()=>{})){const s=t.method?t.method.toLocaleLowerCase():"post";switch(t.body&&t.headers&&!t.headers["Content-Type"]&&!t.headers["content-type"]&&(t.headers["content-type"]="application/x-www-form-urlencoded"),t.headers&&(delete t.headers["Content-Length"],delete t.headers["content-length"]),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient[s](t,(t,s,a)=>{!t&&s&&(s.body=a,s.statusCode=s.status?s.status:s.statusCode,s.status=s.statusCode),e(t,s,a)});break;case"Quantumult X":t.method=s,this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:a,headers:r,body:i,bodyBytes:o}=t;e(null,{status:s,statusCode:a,headers:r,body:i,bodyBytes:o},i,o)},t=>e(t&&t.error||"UndefinedError"));break;case"Node.js":let a=require("iconv-lite");this.initGotEnv(t);const{url:r,...i}=t;this.got[s](r,i).then(t=>{const{statusCode:s,statusCode:r,headers:i,rawBody:o}=t,n=a.decode(o,this.encoding);e(null,{status:s,statusCode:r,headers:i,rawBody:o,body:n},n)},t=>{const{message:s,response:r}=t;e(s,r,r&&a.decode(r.rawBody,this.encoding))})}}time(t,e=null){const s=e?new Date(e):new Date;let a={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in a)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?a[e]:("00"+a[e]).substr((""+a[e]).length)));return t}queryStr(t){let e="";for(const s in t){let a=t[s];null!=a&&""!==a&&("object"==typeof a&&(a=JSON.stringify(a)),e+=`${s}=${a}&`)}return e=e.substring(0,e.length-1),e}msg(e=t,s="",a="",r){const i=t=>{switch(typeof t){case void 0:return t;case"string":switch(this.getEnv()){case"Surge":case"Stash":default:return{url:t};case"Loon":case"Shadowrocket":return t;case"Quantumult X":return{"open-url":t};case"Node.js":return}case"object":switch(this.getEnv()){case"Surge":case"Stash":case"Shadowrocket":default:{let e=t.url||t.openUrl||t["open-url"];return{url:e}}case"Loon":{let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}case"Quantumult X":{let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl,a=t["update-pasteboard"]||t.updatePasteboard;return{"open-url":e,"media-url":s,"update-pasteboard":a}}case"Node.js":return}default:return}};if(!this.isMute)switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:$notification.post(e,s,a,i(r));break;case"Quantumult X":$notify(e,s,a,i(r));break;case"Node.js":}if(!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),a&&t.push(a),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":case"Quantumult X":default:this.log("",`❗️${this.name}, 错误!`,t);break;case"Node.js":this.log("",`❗️${this.name}, 错误!`,t.stack)}}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;switch(this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":case"Quantumult X":default:$done(t);break;case"Node.js":process.exit(1)}}}(t,e)}